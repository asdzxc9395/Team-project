<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="Team.project.dao.AssignmentDao">

<resultMap type="Assignment" id="AssignmentMap">
    <id column="assignment_no" property="assignmentNo"/>
    <result column="class_no" property="classNo"/>
    <result column="member_no" property="memberNo"/>
    <result column="title" property="title"/>
    <result column="content" property="content"/>
    <result column="file" property="file"/>
    <result column="deadline" property="deadline"/>
    <result column="standard" property="standard"/>
    <result column="create_date" property="createDate"/>
    <association property="question" javaType="Question">
    <id column="question_no"   property="questionNo"/>
    <result column="title" property="title"/>
    <result column="create_date" property="createDate"/>
    </association>
    
    
</resultMap>

<select id="findByClassNo" resultMap="AssignmentMap" parameterType="int">
  select class_no, assignment_no, title 
  from assignment 
  where class_no=#{no}
  order by assignment_no
</select>

<insert id="insert" parameterType="Assignment">
  insert into assignment(class_no, member_no, title, content, file, deadline, standard)
  values(
    #{classNo},
    #{memberNo},
    #{title},
    #{content},
    #{file},
    #{deadline},
    #{standard}
  )

</insert>

  <select id="findAllByLesson" resultMap="AssignmentMap" parameterType="int">
select 
  c.class_no, a.assignment_no as no, a.title, a.create_date, a.deadline
from 
  assignment a, class c
where c.class_no=#{no}
union 
select 
  c.class_no, q.question_no as no, q.title, q.create_date, q.deadline
from 
  question q, class c
where c.class_no=#{no}
order by deadline, no desc;
  </select>
  

</mapper>